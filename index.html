<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pendataan Anggota PMII Rayon FTIK UNUSIA</title>

<style>

*{box-sizing:border-box;margin:0;padding:0;}

body{
font-family:'Segoe UI',sans-serif;
background:#eef4ff;
padding:15px;
}

.container{
width:100%;
max-width:550px;
margin:auto;
background:white;
border-radius:18px;
box-shadow:0 8px 25px rgba(0,0,0,0.08);
overflow:hidden;
margin-bottom:15px;
}

.header{
background:linear-gradient(135deg,#0b5ed7,#ffd400);
padding:18px 15px;
text-align:center;
color:white;
}

.logo-area{
display:flex;
flex-wrap:wrap;
justify-content:center;
gap:10px;
margin-bottom:10px;
}

.logo-area img{
height:45px;
background:white;
padding:4px;
border-radius:8px;
}

h2{font-size:18px;line-height:1.4;}

.form-area{padding:18px;}

input,select{
width:100%;
padding:14px;
margin:8px 0;
border:2px solid #e2e8f0;
border-radius:10px;
font-size:15px;
}

input:focus,select:focus{
border-color:#0b5ed7;
outline:none;
}

.preview{text-align:center;margin-top:10px;}

.preview img{
width:100%;
max-width:130px;
border-radius:12px;
border:3px solid #ffd400;
}

button{
width:100%;
padding:15px;
background:#0b5ed7;
color:white;
border:none;
border-radius:10px;
font-size:16px;
font-weight:bold;
margin-top:10px;
cursor:pointer;
}

button:active{transform:scale(0.97);}

.info-sudah{
text-align:center;
padding:20px;
}

.info-sudah h3{
margin-bottom:10px;
color:#0b5ed7;
}

</style>
</head>

<body>

<!-- HALAMAN SUDAH ISI -->
<div id="sudahIsi" style="display:none;">
<div class="container">

<div class="header">

<div class="logo-area">
<img src="logopmii.png">
<img src="logopk.jpeg">
<img src="logorayon.jpg">
<img src="logokopri.jpeg">
</div>

<h2>Data Anggota Sudah Terdaftar</h2>

</div>

<div class="info-sudah">

<h3>Terima kasih ðŸ™Œ</h3>
<p>Anda sudah pernah mengisi pendataan anggota PMII Rayon FTIK UNUSIA.</p>

<button onclick="hapusData()">Isi Ulang Data</button>

</div>

</div>
</div>

<!-- FORM -->
<div class="container" id="formContainer">

<div class="header">

<div class="logo-area">
<img src="logopmii.png">
<img src="logopk.jpeg">
<img src="logorayon.jpg">
<img src="logokopri.jpeg">
</div>

<h2>Pendataan Anggota PMII Rayon FTIK UNUSIA</h2>

</div>

<div class="form-area">

<form id="form">

<input name="nama" placeholder="Nama Lengkap" required>
<input name="nim" placeholder="NIM" required>
<input name="prodi" placeholder="Prodi" required>
<input name="angkatan" placeholder="Angkatan" required>
<input name="hp" placeholder="Nomor HP" required>

<select name="status" required>
<option value="">-- Status Kaderisasi --</option>
<option>MAPABA</option>
<option>PKD</option>
</select>

<input name="jabatan" placeholder="Jabatan Rayon (Opsional)">
<input type="file" id="foto" accept="image/*" required>

<div class="preview">
<img id="preview" style="display:none;">
</div>

<button type="submit">Kirim Data</button>

</form>

</div>
</div>

<script>

const scriptURL="https://script.google.com/macros/s/AKfycbws2o5FtvTqEyvtqeWJU_vkbXNIKvzOTynz-FQReif6r7PGVgHw9rmIENilM_AzyIbSMw/exec";

const form=document.getElementById("form");
const preview=document.getElementById("preview");
const sudahIsiDiv=document.getElementById("sudahIsi");
const formContainer=document.getElementById("formContainer");

if(localStorage.getItem("sudahIsiPMII")){
formContainer.style.display="none";
sudahIsiDiv.style.display="block";
}

document.getElementById("foto").addEventListener("change",function(){
const file=this.files[0];
if(file){
preview.src=URL.createObjectURL(file);
preview.style.display="block";
}
});

form.addEventListener("submit",async function(e){

e.preventDefault();

const fileInput=document.getElementById("foto").files[0];
const reader=new FileReader();

reader.onload=async function(){

const base64=reader.result.split(",")[1];

const formData=new FormData(form);
const data=Object.fromEntries(formData.entries());

data.foto=base64;
data.tipe_foto=fileInput.type;

await fetch(scriptURL,{
method:"POST",
body:JSON.stringify(data)
});

alert("Data anggota berhasil dikirim");

localStorage.setItem("sudahIsiPMII","true");

form.reset();
location.reload();

};

reader.readAsDataURL(fileInput);

});

function hapusData(){
localStorage.removeItem("sudahIsiPMII");
location.reload();
}

</script>

</body>
</html>
